---
title: "統計學與實習"
author: "Hochia"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
date: 2019-10-10T21:13:14-05:00
categories: ["R"]
tags: ["R Markdown", "plot", "regression"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = "#>", collapse = TRUE, echo = TRUE, error = TRUE, cache = TRUE)
library(tidyverse)
```

# 10/17 迴圈、敘述統計、機率模型

## 學習目標

比較常態分佈

1. 相同的平均值，不同的標準差

2. 不同的平均值，相同的標準差

## 資料框 data frame

建立資料框

**法一**

```{r}
df <- data.frame(a = 1:3, b = 4:6)
```

```{r, echo=FALSE}
df
```

**法二**

```{r}
df <- data.frame(
  matrix(1:6, nrow = 3))

names(df) <- c("a", "b")
```

```{r, echo=FALSE}
df
```

**法三**

```{r}
df <- data.frame(
  matrix(0, nrow = 3, ncol = 2))

df[[1]] <- 1:3
df[[2]] <- 4:6
```

```{r, echo=FALSE}
df
```

## 習題

分別從 $N(\mu = 0, \sigma = 1)$、$N(\mu = 0, \sigma = 2)$、$N(\mu = 5, \sigma = 1)$ 抽出 1000 個樣本。

其中，$N$ 表示常態分佈，$\mu$ 表示平均值，$\sigma$ 表示標準差。

畫圖比較

(1) 相同的平均值，不同的標準差

(2) 不同的平均值，相同的標準差

```{r, echo = FALSE}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 6))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
df[[3]] <- rnorm(1000, mean = 0, sd = 2)
df[[4]] <- dnorm(df[[3]], mean = 0, sd = 2)
df[[5]] <- rnorm(1000, mean = 5, sd = 1)
df[[6]] <- dnorm(df[[5]], mean = 5, sd = 1)

plot(x = df[[1]], y = df[[2]], xlim = c(-3,3), ylim = c(0,0.5))
par(new = T)
plot(x = df[[3]], y = df[[4]], xlim = c(-3,3), ylim = c(0,0.5))
plot(x = df[[1]], y = df[[2]], xlim = c(-3,8), ylim = c(0,0.5))
par(new = T)
plot(x = df[[5]], y = df[[6]], xlim = c(-3,8), ylim = c(0,0.5))
```


```{r}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 2))

df[[1]] <- rnorm(n = 1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
```

`rnorm()` 隨機抽樣

`dnorm()` 抽出樣本的機率

```{r}
plot(x = df[[1]], y = df[[2]])
```

依此類推，分別對三種分布抽出 1000 個樣本。

```{r, eval=FALSE}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 6))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
df[[3]] <- rnorm(____, mean = 0, sd = 2)
df[[4]] <- dnorm(____, mean = 0, sd = 2)
df[[5]] <- rnorm(____, mean = 5, sd = 1)
df[[6]] <- dnorm(____, mean = 5, sd = 1)
```

知道函數 argument 的順序，可以省略 argument。

```{r, eval=FALSE}
# 這兩個一樣
df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[1]] <- rnorm(1000, 0, 1)
```

```{r, echo = FALSE}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 6))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
df[[3]] <- rnorm(1000, mean = 0, sd = 2)
df[[4]] <- dnorm(df[[3]], mean = 0, sd = 2)
df[[5]] <- rnorm(1000, mean = 5, sd = 1)
df[[6]] <- dnorm(df[[5]], mean = 5, sd = 1)
```

第一小題，在比較相同的平均值，不同的標準差的時候，會需要疊圖，疊圖的方法是使用 `par(new = T)`，

```{r}
plot(x = df[[1]], y = df[[2]])
par(new = T)
plot(x = df[[3]], y = df[[4]])
```

但是尺度可能不一樣，用 `xlim()`，`ylim()` 限制範圍。

```{r}
plot(x = df[[1]], y = df[[2]], xlim = c(-3,3), ylim = c(0,0.5))
par(new = T)
plot(x = df[[3]], y = df[[4]], xlim = c(-3,3), ylim = c(0,0.5))
```

以此類推，第二小題，

```{r, eval = FALSE}
plot(x = df[[1]], y = df[[2]], xlim = c(__,__), ylim = c(__,__))
par(new = T)
plot(x = _______, y = _______, xlim = c(__,__), ylim = c(__,__))
```

# 10/24 統計圖表繪製

## Review

[Find the **Base R** cheetsheet](https://rstudio.com/resources/cheatsheets/)

承 10/17 實習課的內容，介紹進階的資料視覺化方法。

```{r, echo = FALSE}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 6))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
df[[3]] <- rnorm(1000, mean = 0, sd = 2)
df[[4]] <- dnorm(df[[3]], mean = 0, sd = 2)
df[[5]] <- rnorm(1000, mean = 5, sd = 1)
df[[6]] <- dnorm(df[[5]], mean = 5, sd = 1)
```

## 學習目標

介紹 `plot()` 和 `ggplot()` 的做法。

## `plot()`

```{r}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 2))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)

plot(x = df[[1]], y = df[[2]], 
     xlim = c(-3,3), ylim = c(0,0.5))
```

```{r}
head(df)
```

圖表標題，`main = "__"`，

```{r}
plot(x = df[[1]], y = df[[2]], 
     xlim = c(-3,3), ylim = c(0,0.5),
     main = "Normal distribution",
     xlab = "x", ylab = "y")
```

更改坐標軸名稱，`xlab = "__"`，`ylab = "__"`，

```{r}
plot(x = df[[1]], y = df[[2]], 
     xlim = c(-3,3), ylim = c(0,0.5),
     xlab = "x", ylab = "y")
```

顏色 `col = "____"`，

```{r}
plot(x = df[[1]], y = df[[2]], 
     xlim = c(-3,3), ylim = c(0,0.5),
     col = "plum")
```

點的形狀 `pch = 20`，

```{r}
plot(x = df[[1]], y = df[[2]], 
     xlim = c(-3,3), ylim = c(0,0.5),
     pch = 20)
```

## `ggplot()`

[Find the **Data Visualization Cheat Sheet**](https://rstudio.com/resources/cheatsheets/)

```{r, eval = FALSE}
install.packages("ggplot2")
library(ggplot2)
```

```{r}
head(df)
```

基本

```{r}
ggplot(data = df) +
  geom_point(mapping = aes(X1, X2))
```

或者也可以寫成

```{r}
ggplot(df) +
  geom_point(aes(X1, X2))
```

坐標軸名稱與圖表標題

```{r}
ggplot(data = df) +
  geom_point(mapping = aes(X1, X2)) +
  labs(x = "x", y = "y", title = "Normal distribution")
```

注意 argument 順序

```{r}
ggplot(df) +
  geom_point(aes(X1, X2)) +
  labs("Normal distribution", "x", "y")
```

座標軸範圍限制

```{r}
ggplot(data = df) +
  geom_point(mapping = aes(X1, X2)) +
  coord_cartesian(xlim = c(-3, 3), ylim = c(0, 0.5))
```

顏色

```{r}
ggplot(data = df) +
  geom_point(mapping = aes(X1, X2), color = "orange") +
  coord_cartesian(xlim = c(-3, 3), ylim = c(0, 0.5))
```

畫圖主題

```{r}
ggplot(data = df) +
  geom_point(mapping = aes(X1, X2)) +
  theme_classic()
```

疊圖方法

```{r, eval=FALSE}
ggplot(data = df) +
  geom_point(mapping = aes(X1, X2)) +
  geom_point(mapping = aes(X3, X4)) +
  theme_classic()
```

## 習題

進一步視覺化 10/17 實習的題目，包括 (1) 圖表標題 (2) 坐標軸名稱 (3) 顏色

分別從 $N(\mu = 0, \sigma = 1)$、$N(\mu = 0, \sigma = 2)$、$N(\mu = 5, \sigma = 1)$ 抽出 1000 個樣本。

其中，$N$ 表示常態分佈，$\mu$ 表示平均值，$\sigma$ 表示標準差。

畫圖比較

(1) 相同的平均值，不同的標準差

(2) 不同的平均值，相同的標準差

```{r, echo = FALSE}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 6))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
df[[3]] <- rnorm(1000, mean = 0, sd = 2)
df[[4]] <- dnorm(df[[3]], mean = 0, sd = 2)
df[[5]] <- rnorm(1000, mean = 5, sd = 1)
df[[6]] <- dnorm(df[[5]], mean = 5, sd = 1)

ggplot(data = df) +
  geom_point(mapping = aes(X1, X2), color = "plum") +
  geom_point(mapping = aes(X3, X4), color = "red") +  
  geom_point(mapping = aes(X5, X6), color = "orange") +
  labs(x = "x", y = "y", title = "Normal distribution") +
  coord_cartesian(xlim = c(-3, 8), ylim = c(0, 0.5)) +
  theme_classic()
```

# 10/31 區間估計

## 學習目標

了解 `qnorm()` 和在 R 取"部分"的方法。

```{r}
qnorm(0, 0, 1)
qnorm(0.25, 0, 1)
qnorm(0.50, 0, 1)
qnorm(0.75, 0, 1)
qnorm(1, 0, 1)
```

從簡單的樣本出發，

```{r}
df <- data.frame(
  matrix(0, nrow = 10, ncol = 2))

df[[1]] <- rnorm(10, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
```

```{r, echo=FALSE}
df
```

取出小於 25 百分位的樣本，注意逗點位置，

```{r}
df[df$X1 < qnorm(0.25, 0, 1),]
df[df[[1]] < qnorm(0.25, 0, 1),]
```

兩個以上的條件，`&` 表示"且"，`|` 表示"或"，取出小於 25 百分位的樣本**或**大於 75百分位的樣本。

```{r}
df[df$X1 < qnorm(0.25, 0, 1) | df$X1 > qnorm(0.75, 0, 1),]
```

## 習題

從 $N(\mu = 0, \sigma = 1)$ 抽出 1000 個樣本，找出其雙尾 95% 信賴區間，區間內的樣本以紅色表示。

```{r, echo=FALSE}
df <- data.frame(
  matrix(0, nrow = 1000, ncol = 2))

df[[1]] <- rnorm(1000, mean = 0, sd = 1)
df[[2]] <- dnorm(df[[1]], mean = 0, sd = 1)
CI <- df[df$X1 > qnorm(0.025, 0, 1) & df$X1 < qnorm(0.975, 0, 1),]

plot(x = df[[1]], y = df[[2]], 
     xlim = c(-3,3), ylim = c(0,0.5))
par(new = T)
plot(x = CI$X1, y = CI$X2, 
     xlim = c(-3,3), ylim = c(0,0.5),
     xlab = "", ylab = "",
     col = "red")
```




